<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Binary data example • outstandR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Binary data example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">outstandR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Binary_data_example.html">Binary data example</a></li>
    <li><a class="dropdown-item" href="../articles/Binary_data_Remiro-Azocar.html">Binary data example usind data from Remiro-Azocar et al. (2020)</a></li>
    <li><a class="dropdown-item" href="../articles/comparison-with-other-packages.html">Comparison with other packages</a></li>
    <li><a class="dropdown-item" href="../articles/Continuous_data_example.html">Continuous data example</a></li>
    <li><a class="dropdown-item" href="../articles/Count_data_example.html">Count data example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/StatisticsHealthEconomics/outstandR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Binary data example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/StatisticsHealthEconomics/outstandR/blob/HEAD/vignettes/Binary_data_example.Rmd" class="external-link"><code>vignettes/Binary_data_example.Rmd</code></a></small>
      <div class="d-none name"><code>Binary_data_example.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Population adjustment methods such as <em>matching-adjusted indirect
comparison</em> (MAIC) are increasingly used to compare marginal
treatment effects when there are cross-trial differences in effect
modifiers and limited patient-level data. MAIC is based on propensity
score weighting, which is sensitive to poor covariate overlap and cannot
extrapolate beyond the observed covariate space. Current outcome
regression-based alternatives can extrapolate but target a conditional
treatment effect that is incompatible in the indirect comparison. When
adjusting for covariates, one must integrate or average the conditional
estimate over the relevant population to recover a compatible marginal
treatment effect.</p>
<p>We propose a marginalization method based on <em>parametric
G-computation</em> that can be easily applied where the outcome
regression is a generalized linear model or a Cox model. The approach
views the covariate adjustment regression as a nuisance model and
separates its estimation from the evaluation of the marginal treatment
effect of interest. The method can accommodate a Bayesian statistical
framework, which naturally integrates the analysis into a probabilistic
framework. A simulation study provides proof-of-principle and benchmarks
the method’s performance against MAIC and the conventional outcome
regression. Parametric G-computation achieves more precise and more
accurate estimates than MAIC, particularly when covariate overlap is
poor, and yields unbiased marginal treatment effect estimates under no
failures of assumptions. Furthermore, the marginalized
regression-adjusted estimates provide greater precision and accuracy
than the conditional estimates produced by the conventional outcome
regression.</p>
</div>
<div class="section level2">
<h2 id="general-problem">General problem<a class="anchor" aria-label="anchor" href="#general-problem"></a>
</h2>
<p>Consider one trial, for which the company has IPD, comparing
treatments <em>A</em> and <em>C</em>, from herein call the <em>AC</em>
trial. Also, consider a second trial comparing treatments <em>B</em> and
<em>C</em>, similarly called the <em>BC</em> trial. For this trial only
published aggregate data are available. We wish to estimate a comparison
of the effects of treatments <em>A</em> and <em>B</em> on an appropriate
scale in some target population <em>P</em>, denoted by the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mrow><mi>A</mi><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">d_{AB(P)}</annotation></semantics></math>.
We make use of bracketed subscripts to denote a specific population.
Within the <em>BC</em> population there are parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\mu_{B(BC)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\mu_{C(BC)}</annotation></semantics></math>
representing the expected outcome on each treatment (including
parameters for treatments not studied in the <em>BC</em> trial,
e.g. treatment <em>A</em>). The <em>BC</em> trial provides estimators
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Y</mi><mo accent="true">‾</mo></mover><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\bar{Y}_{B(BC)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Y</mi><mo accent="true">‾</mo></mover><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\bar{Y}_{C(BC)}</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\mu_{B(BC)}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\mu_{C(BC)}</annotation></semantics></math>,
respectively, which are the summary outcomes. It is the same situation
for the <em>AC</em> trial.</p>
<p>For a suitable scale, for example a log-odds ratio, or risk
difference, we form estimators
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>B</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\Delta_{BC(BC)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>A</mi><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">\Delta_{AC(AC)}</annotation></semantics></math>
of the trial level (or marginal) relative treatment effects. We shall
assume that this is always represented as a difference so, for example,
for the risk ratio this is on the log scale.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Δ</mi><mrow><mi>A</mi><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>=</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Y</mi><mo accent="true">‾</mo></mover><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Y</mi><mo accent="true">‾</mo></mover><mrow><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\Delta_{AB(BC)} = g(\bar{Y}_{B{(BC)}}) - g(\bar{Y}_{A{(BC)}})
</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="example-analysis">Example analysis<a class="anchor" aria-label="anchor" href="#example-analysis"></a>
</h2>
<p>First, let us load necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span>      <span class="co"># non-parametric bootstrap in MAIC and ML G-computation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://copula.r-forge.r-project.org/" class="external-link">copula</a></span><span class="op">)</span>    <span class="co"># simulating BC covariates from Gaussian copula</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a></span><span class="op">)</span>  <span class="co"># fit outcome regression, draw outcomes in Bayesian G-computation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://StatisticsHealthEconomics.github.io/outstandR">outstandR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simcovariates</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>We consider binary outcomes using the log-odds ratio as the measure
of effect. For example, the binary outcome may be response to treatment
or the occurrence of an adverse event. For trials <em>AC</em> and
<em>BC</em>, outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>
for subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is simulated from a Bernoulli distribution with probabilities of success
generated from logistic regression.</p>
<p>For the <em>BC</em> trial, the individual-level covariates and
outcomes are aggregated to obtain summaries. The continuous covariates
are summarized as means and standard deviations, which would be
available to the analyst in the published study in a table of baseline
characteristics in the RCT publication. The binary outcomes are
summarized in an overall event table. Typically, the published study
only provides aggregate information to the analyst.</p>
<p>The IPD simulation input parameters are given below.</p>
<table class="table">
<colgroup>
<col width="17%">
<col width="65%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Description</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>N</code></td>
<td>Sample size</td>
<td>200</td>
</tr>
<tr class="even">
<td><code>allocation</code></td>
<td>Active treatment vs. placebo allocation ratio (2:1)</td>
<td>2/3</td>
</tr>
<tr class="odd">
<td><code>b_trt</code></td>
<td>Conditional effect of active treatment vs. comparator
(log(0.17))</td>
<td>-1.77196</td>
</tr>
<tr class="even">
<td><code>b_X</code></td>
<td>Conditional effect of each prognostic variable (-log(0.5))</td>
<td>0.69315</td>
</tr>
<tr class="odd">
<td><code>b_EM</code></td>
<td>Conditional interaction effect of each effect modifier
(-log(0.67))</td>
<td>0.40048</td>
</tr>
<tr class="even">
<td><code>meanX_AC[1]</code></td>
<td>Mean of prognostic factor X3 in AC trial</td>
<td>0.45</td>
</tr>
<tr class="odd">
<td><code>meanX_AC[2]</code></td>
<td>Mean of prognostic factor X4 in AC trial</td>
<td>0.45</td>
</tr>
<tr class="even">
<td><code>meanX_EM_AC[1]</code></td>
<td>Mean of effect modifier X1 in AC trial</td>
<td>0.45</td>
</tr>
<tr class="odd">
<td><code>meanX_EM_AC[2]</code></td>
<td>Mean of effect modifier X2 in AC trial</td>
<td>0.45</td>
</tr>
<tr class="even">
<td><code>meanX_BC[1]</code></td>
<td>Mean of prognostic factor X3 in BC trial</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td><code>meanX_BC[2]</code></td>
<td>Mean of prognostic factor X4 in BC trial</td>
<td>0.6</td>
</tr>
<tr class="even">
<td><code>meanX_EM_BC[1]</code></td>
<td>Mean of effect modifier X1 in BC trial</td>
<td>0.6</td>
</tr>
<tr class="odd">
<td><code>meanX_EM_BC[2]</code></td>
<td>Mean of effect modifier X2 in BC trial</td>
<td>0.6</td>
</tr>
<tr class="even">
<td><code>sdX</code></td>
<td>Standard deviation of prognostic factors (AC and BC)</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td><code>sdX_EM</code></td>
<td>Standard deviation of effect modifiers</td>
<td>0.4</td>
</tr>
<tr class="even">
<td><code>corX</code></td>
<td>Covariate correlation coefficient</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td><code>b_0</code></td>
<td>Baseline intercept</td>
<td>-0.6</td>
</tr>
</tbody>
</table>
<p>We shall use the <code><a href="https://rdrr.io/pkg/simcovariates/man/gen_data.html" class="external-link">gen_data()</a></code> function available with the
<a href="https://github.com/n8thangreen/simcovariates" class="external-link">simcovariates</a>
package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">allocation</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>      <span class="co"># active treatment vs. placebo allocation ratio (2:1)</span></span>
<span><span class="va">b_trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.17</span><span class="op">)</span>     <span class="co"># conditional effect of active treatment vs. common comparator</span></span>
<span><span class="va">b_X</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>       <span class="co"># conditional effect of each prognostic variable</span></span>
<span><span class="va">b_EM</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.67</span><span class="op">)</span>     <span class="co"># conditional interaction effect of each effect modifier</span></span>
<span><span class="va">meanX_AC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.45</span><span class="op">)</span>       <span class="co"># mean of normally-distributed covariate in AC trial</span></span>
<span><span class="va">meanX_BC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.6</span><span class="op">)</span>         <span class="co"># mean of each normally-distributed covariate in BC</span></span>
<span><span class="va">meanX_EM_AC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.45</span><span class="op">)</span>    <span class="co"># mean of normally-distributed EM covariate in AC trial</span></span>
<span><span class="va">meanX_EM_BC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.6</span><span class="op">)</span>      <span class="co"># mean of each normally-distributed EM covariate in BC</span></span>
<span><span class="va">sdX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span>     <span class="co"># standard deviation of each covariate (same for AC and BC)</span></span>
<span><span class="va">sdX_EM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span>  <span class="co"># standard deviation of each EM covariate</span></span>
<span><span class="va">corX</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>            <span class="co"># covariate correlation coefficient  </span></span>
<span><span class="va">b_0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.6</span>            <span class="co"># baseline intercept coefficient  ##TODO: fixed value</span></span>
<span></span>
<span><span class="va">ipd_trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simcovariates/man/gen_data.html" class="external-link">gen_data</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">b_trt</span>, <span class="va">b_X</span>, <span class="va">b_EM</span>, <span class="va">b_0</span>,</span>
<span>                      <span class="va">meanX_AC</span>, <span class="va">sdX</span>, </span>
<span>                      <span class="va">meanX_EM_AC</span>, <span class="va">sdX_EM</span>, </span>
<span>                      <span class="va">corX</span>, <span class="va">allocation</span>,</span>
<span>                      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The treatment column in the return data is binary and takes values 0
and 1. We will include some extra information about treatment names. To
do this we will define the lable of the two level factor as
<code>A</code> for 1 and <code>C</code> for 0 as follows.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ipd_trial</span><span class="op">$</span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ipd_trial</span><span class="op">$</span><span class="va">trt</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, to obtain the aggregate data we will simulate IPD but with
the additional summarise step. We set different mean values
<code>meanX_BC</code> and <code>meanX_EM_BC</code> but otherwise use the
same parameter values as for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">AC</annotation></semantics></math>
case.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BC.IPD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/simcovariates/man/gen_data.html" class="external-link">gen_data</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">b_trt</span>, <span class="va">b_X</span>, <span class="va">b_EM</span>, <span class="va">b_0</span>,</span>
<span>                   <span class="va">meanX_BC</span>, <span class="va">sdX</span>, </span>
<span>                   <span class="va">meanX_EM_BC</span>, <span class="va">sdX_EM</span>, </span>
<span>                   <span class="va">corX</span>, <span class="va">allocation</span>,</span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cov.X</span> <span class="op">&lt;-</span> <span class="va">BC.IPD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>,</span>
<span>                   .names <span class="op">=</span> <span class="st">"{fn}.{col}"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out.B</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">BC.IPD</span>, <span class="va">trt</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>y.B.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>            y.B.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>            y.B.sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>            N.B <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out.C</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">BC.IPD</span>, <span class="va">trt</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>y.C.sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>            y.C.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>            y.C.sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>            N.C <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ald_trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="va">cov.X</span>, <span class="va">out.C</span>, <span class="va">out.B</span><span class="op">)</span></span></code></pre></div>
<p>This general format of data sets consist of the following.</p>
<div class="section level4">
<h4 id="ipd_trial-individual-patient-data">
<code>ipd_trial</code>: Individual patient data<a class="anchor" aria-label="anchor" href="#ipd_trial-individual-patient-data"></a>
</h4>
<ul>
<li>
<code>X*</code>: patient measurements</li>
<li>
<code>trt</code>: treatment ID (integer)</li>
<li>
<code>y</code>: (logical) indicator of whether event was
observed</li>
</ul>
</div>
<div class="section level4">
<h4 id="ald_trial-aggregate-level-data">
<code>ald_trial</code>: Aggregate-level data<a class="anchor" aria-label="anchor" href="#ald_trial-aggregate-level-data"></a>
</h4>
<ul>
<li>
<code>mean.X*</code>: mean patient measurement</li>
<li>
<code>sd.X*</code>: standard deviation of patient measurement</li>
<li>
<code>y.*.sum</code>: total number of events</li>
<li>
<code>y.*.bar</code>: proportion of events</li>
<li>
<code>N.*</code>: total number of individuals</li>
</ul>
<p>Note that the wildcard <code>*</code> here is usually an integer from
1 or the trial identifier <em>B</em>, <em>C</em>.</p>
<p>Our data look like the following.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ipd_trial</span><span class="op">)</span></span>
<span><span class="co">#&gt;           X1         X2         X3         X4 trt y</span></span>
<span><span class="co">#&gt; 1 0.42066874  1.0957407 0.37118099  1.3291540   A 1</span></span>
<span><span class="co">#&gt; 2 0.51227329  0.9079984 0.30560144 -0.1842358   A 0</span></span>
<span><span class="co">#&gt; 3 1.00347612  0.8136847 1.25054503  1.1986315   A 0</span></span>
<span><span class="co">#&gt; 4 0.05641685  0.5318140 0.54799796  0.6694090   A 0</span></span>
<span><span class="co">#&gt; 5 0.42997845  0.5274304 0.09140568  0.1222184   A 0</span></span>
<span><span class="co">#&gt; 6 0.06916082 -0.3125090 0.99150666 -0.1102693   A 0</span></span></code></pre></div>
<p>There are 4 correlated continuous covariates generated per subject,
simulated from a multivariate normal distribution. Treatment
<code>trt</code> 1 corresponds to new treatment <em>A</em>, and 0 is
standard of care or status quo <em>C</em>. The ITC is ‘anchored’ via
<em>C</em>, the common treatment.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ald_trial</span></span>
<span><span class="co">#&gt;    mean.X1     sd.X1  mean.X2     sd.X2   mean.X3     sd.X3  mean.X4     sd.X4</span></span>
<span><span class="co">#&gt; 1 0.568822 0.3972807 0.623277 0.3850408 0.5787528 0.3906499 0.565223 0.3789089</span></span>
<span><span class="co">#&gt;   y.C.sum   y.C.bar    y.C.sd N.C y.B.sum   y.B.bar    y.B.sd N.B</span></span>
<span><span class="co">#&gt; 1      34 0.5074627 0.5037175  67      34 0.2556391 0.4378691 133</span></span></code></pre></div>
<p>In this case, we have 4 covariate mean and standard deviation values;
and the event total, average and sample size for each treatment
<em>B</em>, and <em>C</em>.</p>
</div>
<div class="section level4">
<h4 id="regression-model">Regression model<a class="anchor" aria-label="anchor" href="#regression-model"></a>
</h4>
<p>The true logistic outcome model which we use to simulate the data
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>X</mi><mn>4</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><msub><mi>β</mi><mrow><mi>E</mi><mi>M</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">I</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>≠</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{logit}(p_{t}) = \beta_0 + \beta_X (X_3 + X_4) + [\beta_{t} + \beta_{EM} (X_1 + X_2)] \; \text{I}(t \neq C)
</annotation></semantics></math></p>
<p>That is, for treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>
the right hand side becomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>X</mi><mn>4</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_0 + \beta_X (X_3 + X_4)</annotation></semantics></math>
and for comparator treatments
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
there is an additional
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><msub><mi>β</mi><mrow><mi>E</mi><mi>M</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_t + \beta_{EM} (X_1 + X_2)</annotation></semantics></math>
component consisting of the effect modifier terms and the coefficient
for the treatment parameter is the log odds-ratio (LOR),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\beta_t</annotation></semantics></math>
(or <code>b_trt</code> in the R code).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>t</mi></msub><annotation encoding="application/x-tex">p_{t}</annotation></semantics></math>
is the probability of experiencing the event of interest for treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level3">
<h3 id="output-statistics">Output statistics<a class="anchor" aria-label="anchor" href="#output-statistics"></a>
</h3>
<p>We will implement for MAIC, STC, and G-computation methods to obtain
the <em>marginal treatment effect</em> and <em>marginal variance</em>.
The definition by which these are calculated depends on the type of data
and outcome scale. For our current example of binary data and log-odds
ratio the marginal treatment effect is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>n</mi><mi>B</mi></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>B</mi></msub><mo>−</mo><msub><mi>n</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>n</mi><mi>C</mi></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>B</mi></msub><mo>−</mo><msub><mi>n</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>B</mi></msub><msub><mi>n</mi><mover><mi>C</mi><mo accent="true">‾</mo></mover></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>C</mi></msub><msub><mi>n</mi><mover><mi>B</mi><mo accent="true">‾</mo></mover></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\log\left( \frac{n_B/(N_B-n_B)}{n_C/(N_B-n_{B})} \right) = \log(n_B n_{\bar{C}}) - \log(n_C n_{\bar{B}})
</annotation></semantics></math></p>
<p>and marginal variance is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msub><mi>n</mi><mi>C</mi></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mover><mi>C</mi><mo accent="true">‾</mo></mover></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mi>B</mi></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mover><mi>B</mi><mo accent="true">‾</mo></mover></msub></mfrac></mrow><annotation encoding="application/x-tex">
\frac{1}{n_C} + \frac{1}{n_{\bar{C}}} + \frac{1}{n_B} + \frac{1}{n_{\bar{B}}}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>B</mi></msub><mo>,</mo><msub><mi>n</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">n_B, n_C</annotation></semantics></math>
are the number of events in each arm and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>C</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{C}</annotation></semantics></math>
is the compliment of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>,
so
e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mover><mi>C</mi><mo accent="true">‾</mo></mover></msub><mo>=</mo><msub><mi>N</mi><mi>C</mi></msub><mo>−</mo><msub><mi>n</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">n_{\bar{C}} = N_C - n_c</annotation></semantics></math>.
Other scales will be discussed below.</p>
</div>
</div>
<div class="section level2">
<h2 id="model-fitting-in-r">Model fitting in R<a class="anchor" aria-label="anchor" href="#model-fitting-in-r"></a>
</h2>
<p>The <a href="https://StatisticsHealthEconomics.github.io/outstandR">outstandR</a> package has been written to be easy to
use and essential consists of a single function,
<code><a href="../reference/outstandR.html">outstandR()</a></code>. This can be used to run all of the different
types of model, which we will call <em>strategies</em>. The first two
arguments of <code><a href="../reference/outstandR.html">outstandR()</a></code> are the individual and
aggregate-level data, respectively.</p>
<p>A <code>strategy</code> argument of <code>outstandR</code> takes
functions called <code>strategy_*()</code>, where the wildcard
<code>*</code> is replaced by the name of the particular method
required, e.g. <code><a href="../reference/strategy.html">strategy_maic()</a></code> for MAIC. Each specific
example is provided below.</p>
<div class="section level3">
<h3 id="model-formula">Model formula<a class="anchor" aria-label="anchor" href="#model-formula"></a>
</h3>
<p>Defining
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">X_1, X_2</annotation></semantics></math>
as effect modifiers,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>3</mn></msub><mo>,</mo><msub><mi>X</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">X_3, X_4</annotation></semantics></math>
as prognostic variables and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
the treatment indicator then the formula used in this model is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>X</mi><mn>4</mn></msub><mo>+</mo><mi>Z</mi><mo>+</mo><mi>Z</mi><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>Z</mi><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">
y = X_3 + X_4 + Z + Z X_1 + Z X_2
</annotation></semantics></math></p>
<p>which corresponds to the following <code>R</code>
<code>formula</code> object passed as an argument to the strategy
function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lin_form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"y ~ X3 + X4 + trt + trt:X1 + trt:X2"</span><span class="op">)</span></span></code></pre></div>
<p>Note that the more succinct formula</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">trt</span><span class="op">*</span><span class="op">(</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">)</span></span></code></pre></div>
<p>Would also include
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">X_1, X_2</annotation></semantics></math>
as prognostic factors so in not equivalent, but could be modified as
follows.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">trt</span><span class="op">*</span><span class="op">(</span><span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">)</span> <span class="op">-</span> <span class="va">X1</span> <span class="op">-</span> <span class="va">X2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="maic">MAIC<a class="anchor" aria-label="anchor" href="#maic"></a>
</h3>
<p>Using the individual level data for <em>AC</em> firstly we perform
non-parametric bootstrap of the <code>maic.boot</code> function with
<code>R = 1000</code> replicates. This function fits treatment
coefficient for the marginal effect for <em>A</em> vs <em>C</em>. The
returned value is an object of class <code>boot</code> from the
<code>{boot}</code> package. We then calculate the bootstrap mean and
variance in the wrapper function <code>maic_boot_stats</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_maic</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_maic</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The returned object is of class <code>outstandR</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">outstandR_maic</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ contrasts:List of 3</span></span>
<span><span class="co">#&gt;   ..$ means    :List of 3</span></span>
<span><span class="co">#&gt;   .. ..$ AB: num -1</span></span>
<span><span class="co">#&gt;   .. ..$ AC: num -2.1</span></span>
<span><span class="co">#&gt;   .. ..$ BC: num -1.1</span></span>
<span><span class="co">#&gt;   ..$ variances:List of 3</span></span>
<span><span class="co">#&gt;   .. ..$ AB: num 0.259</span></span>
<span><span class="co">#&gt;   .. ..$ AC: num 0.16</span></span>
<span><span class="co">#&gt;   .. ..$ BC: num 0.0992</span></span>
<span><span class="co">#&gt;   ..$ CI       :List of 3</span></span>
<span><span class="co">#&gt;   .. ..$ AB: num [1:2] -1.99888 -0.00345</span></span>
<span><span class="co">#&gt;   .. ..$ AC: num [1:2] -2.88 -1.32</span></span>
<span><span class="co">#&gt;   .. ..$ BC: num [1:2] -1.716 -0.481</span></span>
<span><span class="co">#&gt;  $ absolute :List of 2</span></span>
<span><span class="co">#&gt;   ..$ means    :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ A: Named num 0.227</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "names")= chr "mean_A"</span></span>
<span><span class="co">#&gt;   .. ..$ C: Named num 0.698</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "names")= chr "mean_C"</span></span>
<span><span class="co">#&gt;   ..$ variances:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ A: Named num 0.00202</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "names")= chr "mean_A"</span></span>
<span><span class="co">#&gt;   .. ..$ C: Named num 0.0035</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "names")= chr "mean_C"</span></span>
<span><span class="co">#&gt;  - attr(*, "CI")= num 0.95</span></span>
<span><span class="co">#&gt;  - attr(*, "ref_trt")= chr "C"</span></span>
<span><span class="co">#&gt;  - attr(*, "scale")= chr "log_odds"</span></span>
<span><span class="co">#&gt;  - attr(*, "model")= chr "binomial"</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "outstandR" "list"</span></span></code></pre></div>
<p>We see that this is a list object with 3 parts, each containing
statistics between each pair of treatments. These are the mean
contrasts, variances and confidence intervals (CI), respectively. The
default CI is for 95% but can be altered in <code>outstandR</code> with
the <code>CI</code> argument.</p>
<p>A <code>print</code> method is available for <code>outstandR</code>
objects for more human-readable output</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_maic</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_odds</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB            -<span style="color: #BB0000;">1.00</span>    0.259       -<span style="color: #BB0000;">2.00</span>   -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">45</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC            -<span style="color: #BB0000;">2.10</span>    0.160       -<span style="color: #BB0000;">2.88</span>   -<span style="color: #BB0000;">1.32</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC            -<span style="color: #BB0000;">1.10</span>    0.099<span style="text-decoration: underline;">2</span>      -<span style="color: #BB0000;">1.72</span>   -<span style="color: #BB0000;">0.481</span>  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.227   0.002<span style="text-decoration: underline;">02</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.698   0.003<span style="text-decoration: underline;">50</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<div class="section level4">
<h4 id="outcome-scale">Outcome scale<a class="anchor" aria-label="anchor" href="#outcome-scale"></a>
</h4>
<p>If we do not explicitly specify the outcome scale, the default is
that used to fit to the data in the regression model. As we saw, in this
case, the default is log-odds ratio corresponding to the
<code>"logit"</code> link function for binary data. However, we can
change this to some other scale which may be more appropriate for a
particular analysis. So far implemented in the package, the links and
their corresponding relative treatment effect scales are as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Data Type</th>
<th>Model</th>
<th align="left">Scale</th>
<th align="left">Argument</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Binary</td>
<td><code>logit</code></td>
<td align="left">Log-odds ratio</td>
<td align="left"><code>log_odds</code></td>
</tr>
<tr class="even">
<td align="left">Count</td>
<td><code>log</code></td>
<td align="left">Log-risk ratio</td>
<td align="left"><code>log_relative_risk</code></td>
</tr>
<tr class="odd">
<td align="left">Continuous</td>
<td><code>mean</code></td>
<td align="left">Mean difference</td>
<td align="left"><code>risk_difference</code></td>
</tr>
</tbody>
</table>
<p>The full list of possible transformed treatment effect scales are:
log-odds ratio, log-risk ratio, mean difference, risk difference, hazard
ratio, hazard difference.</p>
<p>For binary data the marginal treatment effect and variance are</p>
<ul>
<li><strong>Log-risk ratio</strong></li>
</ul>
<p>Treatment effect is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>B</mi></msub><mi>/</mi><msub><mi>N</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>A</mi></msub><mi>/</mi><msub><mi>N</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\log(n_B/N_B) - \log(n_A/N_A)
</annotation></semantics></math> and variance
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msub><mi>n</mi><mi>B</mi></msub></mfrac><mo>−</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>B</mi></msub></mfrac><mo>+</mo><mfrac><mn>1</mn><msub><mi>n</mi><mi>A</mi></msub></mfrac><mo>−</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>A</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">
\frac{1}{n_B} - \frac{1}{N_B} + \frac{1}{n_A} - \frac{1}{N_A}
</annotation></semantics></math></p>
<ul>
<li><strong>Risk difference</strong></li>
</ul>
<p>Treatment effect is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>n</mi><mi>B</mi></msub><msub><mi>N</mi><mi>B</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>n</mi><mi>A</mi></msub><msub><mi>N</mi><mi>A</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">
\frac{n_B}{N_B} - \frac{n_A}{N_A}
</annotation></semantics></math> and variance
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>n</mi><mi>B</mi></msub><msub><mi>N</mi><mi>B</mi></msub></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>n</mi><mi>B</mi></msub><msub><mi>N</mi><mi>B</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><msub><mi>n</mi><mi>A</mi></msub><msub><mi>N</mi><mi>A</mi></msub></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>n</mi><mi>A</mi></msub><msub><mi>N</mi><mi>A</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\frac{n_B}{N_B} \left( 1 - \frac{n_B}{N_B} \right) + \frac{n_A}{N_A} \left( 1 - \frac{n_A}{N_A} \right)
</annotation></semantics></math></p>
<p>To change the outcome scale, we can pass the <code>scale</code>
argument in the <code><a href="../reference/outstandR.html">outstandR()</a></code> function. For example, to
change the scale to risk difference, we can use the following code.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_maic_lrr</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_maic</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>                                     family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"log_relative_risk"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_maic_lrr</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_relative_risk</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.458</span>    0.087<span style="text-decoration: underline;">0</span>      -<span style="color: #BB0000;">1.04</span>      0.120</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">1.14</span>     0.050<span style="text-decoration: underline;">7</span>      -<span style="color: #BB0000;">1.59</span>     -<span style="color: #BB0000;">0.703</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">0.686</span>    0.036<span style="text-decoration: underline;">4</span>      -<span style="color: #BB0000;">1.06</span>     -<span style="color: #BB0000;">0.312</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.225   0.001<span style="text-decoration: underline;">98</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.695   0.003<span style="text-decoration: underline;">35</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="simulated-treatment-comparison">Simulated treatment comparison<a class="anchor" aria-label="anchor" href="#simulated-treatment-comparison"></a>
</h3>
<p>Simulated treatment comparison (STC) is the conventional outcome
regression method. It involves fitting a regression model of outcome on
treatment and covariates to the IPD. IPD effect modifiers are centred at
the mean <em>BC</em> values.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mi>X</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>n</mi></msub><mo>−</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>𝛃</mi><mrow><mi>𝐄</mi><mi>𝐌</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>t</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐱</mi><mi>𝐧</mi><mrow><mi>𝐄</mi><mi>𝐌</mi></mrow></msubsup><mo>−</mo><msup><mi>𝛉</mi><mrow><mi>𝐄</mi><mi>𝐌</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">I</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>≠</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
g(\mu_n) = \beta_0 + \beta_X (\boldsymbol{x}_n - \boldsymbol{\theta}) + \boldsymbol{\beta_{EM}} (\beta_t + (\boldsymbol{x_n^{EM}} - \boldsymbol{\theta^{EM}}) ) \; \mbox{I}(t \neq C)
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math>
is the intercept,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math>
are the covariate coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>z</mi></msub><annotation encoding="application/x-tex">\beta_z</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math>
are the effect modifier coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>n</mi></msub><annotation encoding="application/x-tex">z_n</annotation></semantics></math>
are the indicator variables of effect alternative treatment.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>
is the link function
e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>.</p>
<p>As already mentioned, running the STC analysis is almost identical to
the previous analysis but we now use the <code><a href="../reference/strategy.html">strategy_stc()</a></code>
strategy function instead and a formula with centered covariates.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>X</mi><mn>4</mn></msub><mo>+</mo><mi>Z</mi><mo>+</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>−</mo><mover><msub><mi>X</mi><mn>1</mn></msub><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>2</mn></msub><mo>−</mo><mover><msub><mi>X</mi><mn>2</mn></msub><mo accent="true">‾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y = X_3 + X_4 + Z + Z (X_1 - \bar{X_1}) + Z (X_2 - \bar{X_2})
</annotation></semantics></math></p>
<p>However, <code><a href="../reference/outstandR.html">outstandR()</a></code> knows how to handle this so we can
simply pass the same (uncentred) formula as before.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_stc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_stc</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outstandR_stc</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_odds</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB            -<span style="color: #BB0000;">1.12</span>   <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC            -<span style="color: #BB0000;">2.21</span>   <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC            -<span style="color: #BB0000;">1.10</span>    0.099<span style="text-decoration: underline;">2</span>      -<span style="color: #BB0000;">1.72</span>     -<span style="color: #BB0000;">0.481</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.153        <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.624        <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>Change the outcome scale</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_stc_lrr</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_stc</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"log_relative_risk"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_stc_lrr</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_relative_risk</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.718</span>   <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">1.40</span>    <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">0.686</span>    0.036<span style="text-decoration: underline;">4</span>      -<span style="color: #BB0000;">1.06</span>     -<span style="color: #BB0000;">0.312</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.153        <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.624        <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>For the last two approaches, we perform G-computation firstly with a
frequentist MLE and then a Bayesian approach.</p>
</div>
<div class="section level3">
<h3 id="parametric-g-computation-with-maximum-likelihood-estimation">Parametric G-computation with maximum-likelihood estimation<a class="anchor" aria-label="anchor" href="#parametric-g-computation-with-maximum-likelihood-estimation"></a>
</h3>
<p>G-computation marginalizes the conditional estimates by separating
the regression modelling from the estimation of the marginal treatment
effect for <em>A</em> versus <em>C</em>. First, a regression model of
the observed outcome
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
on the covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and treatment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is fitted to the <em>AC</em> IPD:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>𝐱</mi><mi>n</mi></msub><msub><mi>𝛃</mi><mi>𝐗</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>z</mi></msub><mo>+</mo><msubsup><mi>𝐱</mi><mi>𝐧</mi><mrow><mi>𝐄</mi><mi>𝐌</mi></mrow></msubsup><msub><mi>𝛃</mi><mrow><mi>𝐄</mi><mi>𝐌</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">I</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>≠</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
g(\mu_n) = \beta_0 + \boldsymbol{x}_n \boldsymbol{\beta_X} + (\beta_z + \boldsymbol{x_n^{EM}} \boldsymbol{\beta_{EM}}) \; \mbox{I}(t \neq C)
</annotation></semantics></math></p>
<p>In the context of G-computation, this regression model is often
called the “Q-model.” Having fitted the Q-model, the regression
coefficients are treated as nuisance parameters. The parameters are
applied to the simulated covariates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>*</mo></mrow><annotation encoding="application/x-tex">x*</annotation></semantics></math>
to predict hypothetical outcomes for each subject under both possible
treatments. Namely, a pair of predicted outcomes, also called potential
outcomes, under <em>A</em> and under <em>C</em>, is generated for each
subject.</p>
<p>By plugging treatment <em>C</em> into the regression fit for every
simulated observation, we predict the marginal outcome mean in the
hypothetical scenario in which all units are under treatment
<em>C</em>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mo>=</mo><msub><mo>∫</mo><msup><mi>x</mi><mo>*</mo></msup></msub><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mo>+</mo><msup><mi>x</mi><mo>*</mo></msup><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">d</mtext><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">
\hat{\mu}_0 = \int_{x^*} g^{-1} (\hat{\beta}_0 + x^* \hat{\beta}_1 ) p(x^*) \; \text{d}x^*
</annotation></semantics></math></p>
<p>To estimate the marginal or population-average treatment effect for
<em>A</em> versus <em>C</em> in the linear predictor scale, one
back-transforms to this scale the average predictions, taken over all
subjects on the natural outcome scale, and calculates the difference
between the average linear predictions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>Δ</mi><mo accent="true">̂</mo></mover><mn>10</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>μ</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\hat{\Delta}^{(2)}_{10} = g(\hat{\mu}_1) - g(\hat{\mu}_0)
</annotation></semantics></math></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_ml</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_gcomp_ml</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outstandR_gcomp_ml</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_odds</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.966</span>    0.242       -<span style="color: #BB0000;">1.93</span>   -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">74</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">2.06</span>     0.142       -<span style="color: #BB0000;">2.80</span>   -<span style="color: #BB0000;">1.33</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">1.10</span>     0.099<span style="text-decoration: underline;">2</span>      -<span style="color: #BB0000;">1.72</span>   -<span style="color: #BB0000;">0.481</span>  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.224   0.001<span style="text-decoration: underline;">89</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.687   0.003<span style="text-decoration: underline;">40</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>Change the outcome scale</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_ml_lrr</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_gcomp_ml</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"log_relative_risk"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_ml_lrr</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_relative_risk</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.463</span>    0.086<span style="text-decoration: underline;">9</span>      -<span style="color: #BB0000;">1.04</span>      0.115</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">1.15</span>     0.050<span style="text-decoration: underline;">5</span>      -<span style="color: #BB0000;">1.59</span>     -<span style="color: #BB0000;">0.708</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">0.686</span>    0.036<span style="text-decoration: underline;">4</span>      -<span style="color: #BB0000;">1.06</span>     -<span style="color: #BB0000;">0.312</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.223   0.002<span style="text-decoration: underline;">05</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.691   0.003<span style="text-decoration: underline;">48</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bayesian-g-computation-with-mcmc">Bayesian G-computation with MCMC<a class="anchor" aria-label="anchor" href="#bayesian-g-computation-with-mcmc"></a>
</h3>
<p>The difference between Bayesian G-computation and its
maximum-likelihood counterpart is in the estimated distribution of the
predicted outcomes. The Bayesian approach also marginalizes, integrates
or standardizes over the joint posterior distribution of the conditional
nuisance parameters of the outcome regression, as well as the joint
covariate distribution.</p>
<p>Draw a vector of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>N</mi><mo>*</mo></msup><annotation encoding="application/x-tex">N^*</annotation></semantics></math>
of predicted outcomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>y</mi><mi>z</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">y^*_z</annotation></semantics></math>
under each set intervention
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>z</mi><mo>*</mo></msup><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">z^* \in \{0, 1\}</annotation></semantics></math>
from its posterior predictive distribution under the specific treatment.
This is defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><msup><mi>z</mi><mo>*</mo></msup><mo>*</mo></msubsup><mo>∣</mo><msub><mi>𝒟</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>∫</mo><mi>β</mi></msub><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><msup><mi>z</mi><mo>*</mo></msup><mo>*</mo></msubsup><mo>∣</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>∣</mo><msub><mi>𝒟</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>β</mi></mrow><annotation encoding="application/x-tex">p(y^*_{z^*} \mid \mathcal{D}_{AC}) = \int_{\beta} p(y^*_{z^*} \mid \beta) p(\beta \mid \mathcal{D}_{AC}) d\beta</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>∣</mo><msub><mi>𝒟</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\beta \mid \mathcal{D}_{AC})</annotation></semantics></math>
is the posterior distribution of the outcome regression coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
which encode the predictor-outcome relationships observed in the
<em>AC</em> trial IPD. This is given by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mrow><msup><mi></mi><mi>z</mi></msup><mo>*</mo></mrow><mo>*</mo></msubsup><mo>∣</mo><msub><mi>𝒟</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>∫</mo><msup><mi>x</mi><mo>*</mo></msup></msub><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>y</mi><mo>*</mo></msup><mo>∣</mo><msup><mi>z</mi><mo>*</mo></msup><mo>,</mo><msup><mi>x</mi><mo>*</mo></msup><mo>,</mo><msub><mi>𝒟</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mo>*</mo></msup><mo>∣</mo><msub><mi>𝒟</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">d</mtext><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">
p(y^*_{^z*} \mid \mathcal{D}_{AC}) = \int_{x^*} p(y^* \mid z^*, x^*, \mathcal{D}_{AC}) p(x^* \mid \mathcal{D}_{AC})\; \text{d}x^*
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msub><mo>∫</mo><msup><mi>x</mi><mo>*</mo></msup></msub><msub><mo>∫</mo><mi>β</mi></msub><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>y</mi><mo>*</mo></msup><mo>∣</mo><msup><mi>z</mi><mo>*</mo></msup><mo>,</mo><msup><mi>x</mi><mo>*</mo></msup><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mo>*</mo></msup><mo>∣</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>∣</mo><msub><mi>𝒟</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mi>d</mi><mi>β</mi><mspace width="0.278em"></mspace><mtext mathvariant="normal">d</mtext><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">
= \int_{x^*} \int_{\beta} p(y^* \mid z^*, x^*, \beta) p(x^* \mid \beta) p(\beta \mid \mathcal{D}_{AC})\; d\beta \; \text{d}x^*
</annotation></semantics></math></p>
<p>In practice, the integrals above can be approximated numerically,
using full Bayesian estimation via Markov chain Monte Carlo (MCMC)
sampling.</p>
<p>The average, variance and interval estimates of the marginal
treatment effect can be derived empirically from draws of the posterior
density.</p>
<p>We can draw a vector of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>N</mi><mo>*</mo></msup><annotation encoding="application/x-tex">N^*</annotation></semantics></math>
of predicted outcomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>y</mi><mi>z</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">y^*_z</annotation></semantics></math>
under each set intervention
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>z</mi><mo>*</mo></msup><annotation encoding="application/x-tex">z^*</annotation></semantics></math>
from its posterior predictive distribution under the specific
treatment.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_stan</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_gcomp_stan</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_stan</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_odds</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.986</span>    0.242       -<span style="color: #BB0000;">1.95</span>    -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">2.08</span>     0.143       -<span style="color: #BB0000;">2.82</span>    -<span style="color: #BB0000;">1.34</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">1.10</span>     0.099<span style="text-decoration: underline;">2</span>      -<span style="color: #BB0000;">1.72</span>    -<span style="color: #BB0000;">0.481</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.225   0.001<span style="text-decoration: underline;">99</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.693   0.003<span style="text-decoration: underline;">40</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>As before, we can change the outcome scale.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_stan_lrr</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_gcomp_stan</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"log_relative_risk"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_stan_lrr</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_relative_risk</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.456</span>    0.084<span style="text-decoration: underline;">8</span>      -<span style="color: #BB0000;">1.03</span>      0.115</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">1.14</span>     0.048<span style="text-decoration: underline;">5</span>      -<span style="color: #BB0000;">1.57</span>     -<span style="color: #BB0000;">0.710</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">0.686</span>    0.036<span style="text-decoration: underline;">4</span>      -<span style="color: #BB0000;">1.06</span>     -<span style="color: #BB0000;">0.312</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A             0.225   0.001<span style="text-decoration: underline;">99</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C             0.693   0.003<span style="text-decoration: underline;">40</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-imputation-marginalisation">Multiple imputation marginalisation<a class="anchor" aria-label="anchor" href="#multiple-imputation-marginalisation"></a>
</h3>
<p>Marginalized treatment effect for aggregate level data study is
obtained by integrating over the covariate distribution from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
study</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mtext mathvariant="normal">marg</mtext></msup><mo>=</mo><msub><mi>𝔼</mi><mrow><mi>X</mi><mo>∼</mo><msub><mi>f</mi><mtext mathvariant="normal">BC</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>μ</mi><mrow><mi>T</mi><mo>=</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>μ</mi><mrow><mi>T</mi><mo>=</mo><mn>0</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mo>∫</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>μ</mi><mrow><mi>T</mi><mo>=</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>μ</mi><mrow><mi>T</mi><mo>=</mo><mn>0</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><msub><mi>f</mi><mtext mathvariant="normal">BC</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">d</mtext><mi>X</mi></mrow><annotation encoding="application/x-tex">
\Delta^{\text{marg}} = \mathbb{E}_{X \sim f_{\text{BC}}(X)} \left[ \mu_{T=1}(X) - \mu_{T=0}(X) \right]
= \int \left[ \mu_{T=1}(X) - \mu_{T=0}(X) \right] f_{\text{BC}}(X) \; \text{d}X
</annotation></semantics></math></p>
<p>The aggregate level data likelihood is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Δ</mi><mo accent="true">̂</mo></mover><mrow><mi>B</mi><mi>C</mi></mrow></msub><mo>∼</mo><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Δ</mi><mtext mathvariant="normal">marg</mtext></msup><mo>,</mo><mi>S</mi><msup><mi>E</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\hat{\Delta}_{BC} \sim \mathcal{N}(\Delta^{\text{marg}}, SE^2)
</annotation></semantics></math></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_mim</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_mim</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outstandR_mim</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_mim</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_odds</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.987</span>    0.231       -<span style="color: #BB0000;">1.93</span>    -<span style="color: #BB0000;">0.045</span><span style="color: #BB0000; text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">2.09</span>     0.132       -<span style="color: #BB0000;">2.80</span>    -<span style="color: #BB0000;">1.37</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">1.10</span>     0.099<span style="text-decoration: underline;">2</span>      -<span style="color: #BB0000;">1.72</span>    -<span style="color: #BB0000;">0.481</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A          <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C          <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>Change the outcome scale again.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_mim_lrr</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">ipd_trial</span>, <span class="va">ald_trial</span>,</span>
<span>            strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_mim</a></span><span class="op">(</span></span>
<span>              formula <span class="op">=</span> <span class="va">lin_form</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            scale <span class="op">=</span> <span class="st">"log_relative_risk"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_mim_lrr</span></span>
<span><span class="co">#&gt; Object of class 'outstandR' </span></span>
<span><span class="co">#&gt; Model: <span style="color: #949494;">binomial</span> </span></span>
<span><span class="co">#&gt; Scale: <span style="color: #949494;">log_relative_risk</span> </span></span>
<span><span class="co">#&gt; Common treatment: <span style="color: #949494;">C</span> </span></span>
<span><span class="co">#&gt; Individual patient data study: <span style="color: #949494;">AC</span> </span></span>
<span><span class="co">#&gt; Aggregate level data study: <span style="color: #949494;">BC</span> </span></span>
<span><span class="co">#&gt; Confidence interval level: <span style="color: #949494;">0.95</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Contrasts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AB           -<span style="color: #BB0000;">0.456</span>    0.074<span style="text-decoration: underline;">4</span>     -<span style="color: #BB0000;">0.991</span>     0.078<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AC           -<span style="color: #BB0000;">1.14</span>     0.038<span style="text-decoration: underline;">0</span>     -<span style="color: #BB0000;">1.52</span>     -<span style="color: #BB0000;">0.760</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BC           -<span style="color: #BB0000;">0.686</span>    0.036<span style="text-decoration: underline;">4</span>     -<span style="color: #BB0000;">1.06</span>     -<span style="color: #BB0000;">0.312</span> </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Absolute:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   Treatments Estimate Std.Error lower.0.95 upper.0.95</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A          <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> C          <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h3>
<div class="section level4">
<h4 id="ac-effect-in-bc-population">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">AC</annotation></semantics></math>
effect in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
population<a class="anchor" aria-label="anchor" href="#ac-effect-in-bc-population"></a>
</h4>
<p>The true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">AC</annotation></semantics></math>
effect on the log OR scale in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
(aggregate trial data) population is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>β</mi><mi>t</mi><mrow><mi>A</mi><mi>C</mi></mrow></msubsup><mo>+</mo><msub><mi>β</mi><mrow><mi>E</mi><mi>M</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>X</mi><mo accent="true">‾</mo></mover><mn>1</mn><mrow><mi>A</mi><mi>C</mi></mrow></msubsup><mo>+</mo><msubsup><mover><mi>X</mi><mo accent="true">‾</mo></mover><mn>2</mn><mrow><mi>A</mi><mi>C</mi></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_t^{AC} + \beta_{EM} (\bar{X}^{AC}_1 + \bar{X}_2^{AC})</annotation></semantics></math>.
Calculated by</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_AC_true</span> <span class="op">&lt;-</span> <span class="va">b_trt</span> <span class="op">+</span> <span class="va">b_EM</span> <span class="op">*</span> <span class="op">(</span><span class="va">ald_trial</span><span class="op">$</span><span class="va">mean.X1</span> <span class="op">+</span> <span class="va">ald_trial</span><span class="op">$</span><span class="va">mean.X2</span><span class="op">)</span></span></code></pre></div>
<p>The naive approach is to just convert directly from one population to
another, ignoring the imbalance in effect modifiers.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_AC_naive</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">ipd_trial</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>y_sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, y_bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">trt</span>,</span>
<span>                     values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_sum</span>, <span class="va">y_bar</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>d_AC <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y_bar_A</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y_bar_A</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y_bar_C</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y_bar_C</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         var_AC <span class="op">=</span></span>
<span>           <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n_A</span><span class="op">-</span><span class="va">y_sum_A</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">y_sum_A</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n_C</span><span class="op">-</span><span class="va">y_sum_C</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">y_sum_C</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ab-effect-in-bc-population">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math>
effect in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
population<a class="anchor" aria-label="anchor" href="#ab-effect-in-bc-population"></a>
</h4>
<p>This is the indirect effect. The true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math>
effect in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
population is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>β</mi><mi>t</mi><mrow><mi>A</mi><mi>C</mi></mrow></msubsup><mo>−</mo><msubsup><mi>β</mi><mi>t</mi><mrow><mi>B</mi><mi>C</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\beta_t^{AC} - \beta_t^{BC}</annotation></semantics></math>.</p>
<p>Following the simulation study in Remiro et al (2020) these cancel
out and the true effect is zero.</p>
<p>The naive comparison calculating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">AB</annotation></semantics></math>
effect in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
population is</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_BC</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">ald_trial</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y.B.bar</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y.B.bar</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">y.C.bar</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y.C.bar</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_AB_naive</span> <span class="op">&lt;-</span> <span class="va">d_AC_naive</span><span class="op">$</span><span class="va">d_AC</span> <span class="op">-</span> <span class="va">d_BC</span></span>
<span></span>
<span><span class="va">var.d.BC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">ald_trial</span>, <span class="fl">1</span><span class="op">/</span><span class="va">y.B.sum</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">N.B</span> <span class="op">-</span> <span class="va">y.B.sum</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">y.C.sum</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">N.C</span> <span class="op">-</span> <span class="va">y.C.sum</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">var.d.AB.naive</span> <span class="op">&lt;-</span> <span class="va">d_AC_naive</span><span class="op">$</span><span class="va">var_AC</span> <span class="op">+</span> <span class="va">var.d.BC</span></span></code></pre></div>
<p>Of course, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
contrast is calculated directly.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>We now combine all outputs and present in plots and tables. For a
log-odds ratio a table of all contrasts and methods in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
population is given below.</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">d_true</th>
<th align="right">d_naive</th>
<th align="right">MAIC</th>
<th align="right">STC</th>
<th align="right">Gcomp.ML</th>
<th align="right">Gcomp.Bayes</th>
<th align="right">MIM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AB</td>
<td align="right">0.00</td>
<td align="right">-0.95</td>
<td align="right">-1.0</td>
<td align="right">-1.12</td>
<td align="right">-0.97</td>
<td align="right">-0.99</td>
<td align="right">-0.99</td>
</tr>
<tr class="even">
<td align="left">AC</td>
<td align="right">-1.29</td>
<td align="right">-2.05</td>
<td align="right">-2.1</td>
<td align="right">-2.21</td>
<td align="right">-2.06</td>
<td align="right">-2.08</td>
<td align="right">-2.09</td>
</tr>
<tr class="odd">
<td align="left">BC</td>
<td align="right">-1.10</td>
<td align="right">-1.10</td>
<td align="right">-1.1</td>
<td align="right">-1.10</td>
<td align="right">-1.10</td>
<td align="right">-1.10</td>
<td align="right">-1.10</td>
</tr>
</tbody>
</table>
<p>We can see that the different corresponds reasonably well with one
another.</p>
<p>Next, let us look at the results on the log relative risk scale.
First, the true values are calculated as</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_AB_true_lrr</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">d_AC_true_lrr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">d_A_true</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">d_C_true</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_AC_true_lrr</span></span></code></pre></div>
<p>so that the summary table is</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">MAIC</th>
<th align="right">STC</th>
<th align="right">Gcomp.ML</th>
<th align="right">Gcomp.Bayes</th>
<th align="right">MIM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AB</td>
<td align="right">-0.46</td>
<td align="right">-0.72</td>
<td align="right">-0.46</td>
<td align="right">-0.46</td>
<td align="right">-0.46</td>
</tr>
<tr class="even">
<td align="left">AC</td>
<td align="right">-1.14</td>
<td align="right">-1.40</td>
<td align="right">-1.15</td>
<td align="right">-1.14</td>
<td align="right">-1.14</td>
</tr>
<tr class="odd">
<td align="left">BC</td>
<td align="right">-0.69</td>
<td align="right">-0.69</td>
<td align="right">-0.69</td>
<td align="right">-0.69</td>
<td align="right">-0.69</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h4>
<p>The same output can be presented in forest plots is as follows. Each
horizontal bar represent a different method and the facets group these
by treatment comparison for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BC</annotation></semantics></math>
population. The log-odds ratio and log risk ratio plot are given
below.</p>
<p><img src="Binary_data_example_files/figure-html/forest-lor-1.png" width="768"></p>
<p><img src="Binary_data_example_files/figure-html/forest-rr-1.png" width="768"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan Green, Antonio Remiro-Azocar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
