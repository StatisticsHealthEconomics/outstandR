<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>COPD Analysis â€¢ outstandR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="COPD Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">outstandR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Binary_data_example.html">Binary data example</a></li>
    <li><a class="dropdown-item" href="../articles/Binary_data_Remiro-Azocar.html">Binary data example usind data from Remiro-Azocar et al. (2020)</a></li>
    <li><a class="dropdown-item" href="../articles/comparison-with-other-packages.html">Comparison with other packages</a></li>
    <li><a class="dropdown-item" href="../articles/Continuous_data_example.html">Continuous data example</a></li>
    <li><a class="dropdown-item" href="../articles/copd_analysis.html">COPD Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Count_data_example.html">Count data example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/StatisticsHealthEconomics/outstandR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>COPD Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/StatisticsHealthEconomics/outstandR/blob/HEAD/vignettes/copd_analysis.Rmd" class="external-link"><code>vignettes/copd_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>copd_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>First, let us load necessary packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span>      <span class="co"># non-parametric bootstrap in MAIC and ML G-computation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://copula.r-forge.r-project.org/" class="external-link">copula</a></span><span class="op">)</span>    <span class="co"># simulating BC covariates from Gaussian copula</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a></span><span class="op">)</span>  <span class="co"># fit outcome regression, draw outcomes in Bayesian G-computation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://StatisticsHealthEconomics.github.io/outstandR">outstandR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">555</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AC.IPD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"raw-data"</span>, <span class="st">"AC_IPD.csv"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># AC patient-level data</span></span>
<span><span class="va">BC.ALD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"raw-data"</span>, <span class="st">"BC_ALD.csv"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># BC aggregate-level data</span></span></code></pre></div>
<p>This general format of data sets consist of the following.</p>
<div class="section level4">
<h4 id="ac-ipd-individual-patient-data">
<code>AC.IPD</code>: Individual patient data<a class="anchor" aria-label="anchor" href="#ac-ipd-individual-patient-data"></a>
</h4>
<ul>
<li>
<code>X*</code>: patient measurements</li>
<li>
<code>trt</code>: treatment ID</li>
<li>
<code>y</code>: (logical) indicator of whether event was
observed</li>
</ul>
</div>
<div class="section level4">
<h4 id="bc-ald-aggregate-level-data">
<code>BC.ALD</code>: Aggregate-level data<a class="anchor" aria-label="anchor" href="#bc-ald-aggregate-level-data"></a>
</h4>
<ul>
<li>
<code>mean.X*</code>: mean patient measurement</li>
<li>
<code>sd.X*</code>: standard deviation of patient measurement</li>
<li>
<code>y.*.sum</code>: total number of events</li>
<li>
<code>y.*.bar</code>: total number of events</li>
<li>
<code>N.*</code>: total number of individuals</li>
</ul>
<p>Note that the wildcard <code>*</code> here is usually an integer from
1 or the trial identifier <em>B</em>, <em>C</em>.</p>
<p>Our data look like the following.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">AC.IPD</span><span class="op">)</span></span>
<span><span class="co">#&gt;            X1        X2          X3          X4 trt y</span></span>
<span><span class="co">#&gt; 1  0.43734111 0.6747901  0.93001035  0.09165363   1 0</span></span>
<span><span class="co">#&gt; 2  0.05643081 0.5987971  0.03557646  0.59954129   1 1</span></span>
<span><span class="co">#&gt; 3 -0.08048882 0.6843784  0.93147222 -0.11419716   1 0</span></span>
<span><span class="co">#&gt; 4 -0.38580926 0.5716644 -0.32252212  0.02551808   1 0</span></span>
<span><span class="co">#&gt; 5  1.00755116 0.8220826  0.92735892  0.84414221   1 1</span></span>
<span><span class="co">#&gt; 6  0.19443956 0.2031329  0.34990179  0.15633009   1 0</span></span></code></pre></div>
<p>There are 4 correlated continuous covariates generated per subject,
simulated from a multivariate normal distribution.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BC.ALD</span></span>
<span><span class="co">#&gt;     mean.X1   mean.X2   mean.X3   mean.X4     sd.X1     sd.X2     sd.X3</span></span>
<span><span class="co">#&gt; 1 0.5908996 0.6414179 0.5856529 0.6023671 0.3863145 0.4033615 0.4076097</span></span>
<span><span class="co">#&gt;      sd.X4 y.B.sum y.B.bar N.B y.C.sum y.C.bar N.C</span></span>
<span><span class="co">#&gt; 1 0.395132     182   0.455 400     149   0.745 200</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="output-statistics">Output statistics<a class="anchor" aria-label="anchor" href="#output-statistics"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="model-fitting-in-r">Model fitting in R<a class="anchor" aria-label="anchor" href="#model-fitting-in-r"></a>
</h2>
<div class="section level3">
<h3 id="maic">MAIC<a class="anchor" aria-label="anchor" href="#maic"></a>
</h3>
<p>The formula used in this model is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>X</mi><mn>4</mn></msub><mo>+</mo><msub><mi>Î²</mi><mi>t</mi></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>Î²</mi><mi>t</mi></msub><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">
y = X_3 + X_4 + \beta_t X_1 + \beta_t X_2
</annotation></semantics></math> which corresponds to the following
<code>R</code> <code>formula</code> object passed as an argument to the
strategy function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lin_form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"y ~ X3 + X4 + trt*X1 + trt*X2"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_maic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">AC.IPD</span>, <span class="va">BC.ALD</span>, strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_maic</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lin_form</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The returned object is of class <code>outstandR</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_maic</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stc">STC<a class="anchor" aria-label="anchor" href="#stc"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¼</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>n</mi></msub><mo>âˆ’</mo><mi>ğ›‰</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î²</mi><mn>1</mn></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mi>z</mi></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ğ±</mi><mi>ğ§</mi><mrow><mi>ğ„</mi><mi>ğŒ</mi></mrow></msubsup><mo>âˆ’</mo><msup><mi>ğ›‰</mi><mrow><mi>ğ„</mi><mi>ğŒ</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›ƒ</mi><mn>ğŸ</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">I</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
g(\mu_n) = \beta_0 + (\boldsymbol{x}_n - \boldsymbol{\theta}) \beta_1 + (\beta_z + (\boldsymbol{x_n^{EM}} - \boldsymbol{\theta^{EM}}) \boldsymbol{\beta_2}) \; \mbox{I}(z_n=1)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>X</mi><mn>3</mn></msub><mo>+</mo><msub><mi>X</mi><mn>4</mn></msub><mo>+</mo><msub><mi>Î²</mi><mi>t</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo>âˆ’</mo><mover><msub><mi>X</mi><mn>1</mn></msub><mo accent="true">â€¾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Î²</mi><mi>t</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>2</mn></msub><mo>âˆ’</mo><mover><msub><mi>X</mi><mn>2</mn></msub><mo accent="true">â€¾</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
y = X_3 + X_4 + \beta_t(X_1 - \bar{X_1}) + \beta_t(X_2 - \bar{X_2})
</annotation></semantics></math> However, <code><a href="../reference/outstandR.html">outstandR()</a></code> knows
how to handle this so we can simply pass the same (uncentred) formula as
before.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_stc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">AC.IPD</span>, <span class="va">BC.ALD</span>, strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_stc</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lin_form</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outstandR_stc</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parametric-g-computation-with-maximum-likelihood-estimation">Parametric G-computation with maximum-likelihood estimation<a class="anchor" aria-label="anchor" href="#parametric-g-computation-with-maximum-likelihood-estimation"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¼</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î²</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ğ±</mi><mi>n</mi></msub><msub><mi>ğ›ƒ</mi><mn>ğŸ</mn></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mi>z</mi></msub><mo>+</mo><msubsup><mi>ğ±</mi><mi>ğ§</mi><mrow><mi>ğ„</mi><mi>ğŒ</mi></mrow></msubsup><msub><mi>ğ›ƒ</mi><mn>ğŸ</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">I</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>n</mi></msub><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
g(\mu_n) = \beta_0 + \boldsymbol{x}_n \boldsymbol{\beta_1} + (\beta_z + \boldsymbol{x_n^{EM}} \boldsymbol{\beta_2}) \; \mbox{I}(z_n = 1)
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mn>0</mn></msub><mo>=</mo><msub><mo>âˆ«</mo><msup><mi>x</mi><mo>*</mo></msup></msub><msup><mi>g</mi><mrow><mi>âˆ’</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mn>0</mn></msub><mo>+</mo><msup><mi>x</mi><mo>*</mo></msup><msub><mover><mi>Î²</mi><mo accent="true">Ì‚</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">d</mtext><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">
\hat{\mu}_0 = \int_{x^*} g^{-1} (\hat{\beta}_0 + x^* \hat{\beta}_1 ) p(x^*) \; \text{d}x^*
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>Î”</mi><mo accent="true">Ì‚</mo></mover><mn>10</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Î¼</mi><mo accent="true">Ì‚</mo></mover><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\hat{\Delta}^{(2)}_{10} = g(\hat{\mu}_1) - g(\hat{\mu}_0)
</annotation></semantics></math></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">AC.IPD</span>, <span class="va">BC.ALD</span>, strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_gcomp_ml</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lin_form</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">outstandR_gcomp_ml</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bayesian-g-computation-with-mcmc">Bayesian G-computation with MCMC<a class="anchor" aria-label="anchor" href="#bayesian-g-computation-with-mcmc"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mrow><msup><mi></mi><mi>z</mi></msup><mo>*</mo></mrow><mo>*</mo></msubsup><mo>âˆ£</mo><msub><mi>ğ’Ÿ</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>âˆ«</mo><msup><mi>x</mi><mo>*</mo></msup></msub><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>y</mi><mo>*</mo></msup><mo>âˆ£</mo><msup><mi>z</mi><mo>*</mo></msup><mo>,</mo><msup><mi>x</mi><mo>*</mo></msup><mo>,</mo><msub><mi>ğ’Ÿ</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mo>*</mo></msup><mo>âˆ£</mo><msub><mi>ğ’Ÿ</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mtext mathvariant="normal">d</mtext><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">
p(y^*_{^z*} \mid \mathcal{D}_{AC}) = \int_{x^*} p(y^* \mid z^*, x^*, \mathcal{D}_{AC}) p(x^* \mid \mathcal{D}_{AC})\; \text{d}x^*
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msub><mo>âˆ«</mo><msup><mi>x</mi><mo>*</mo></msup></msub><msub><mo>âˆ«</mo><mi>Î²</mi></msub><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>y</mi><mo>*</mo></msup><mo>âˆ£</mo><msup><mi>z</mi><mo>*</mo></msup><mo>,</mo><msup><mi>x</mi><mo>*</mo></msup><mo>,</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mo>*</mo></msup><mo>âˆ£</mo><mi>Î²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î²</mi><mo>âˆ£</mo><msub><mi>ğ’Ÿ</mi><mrow><mi>A</mi><mi>C</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mi>d</mi><mi>Î²</mi><mspace width="0.278em"></mspace><mtext mathvariant="normal">d</mtext><msup><mi>x</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">
= \int_{x^*} \int_{\beta} p(y^* \mid z^*, x^*, \beta) p(x^* \mid \beta) p(\beta \mid \mathcal{D}_{AC})\; d\beta \; \text{d}x^*
</annotation></semantics></math></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_gcomp_stan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">AC.IPD</span>, <span class="va">BC.ALD</span>, strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_gcomp_stan</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lin_form</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 7e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.7 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1200 / 4000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1600 / 4000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2000 / 4000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2001 / 4000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2400 / 4000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2800 / 4000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 3200 / 4000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 3600 / 4000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.174 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.18 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                0.354 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Gradient evaluation took 9e-06 seconds</span></span>
<span><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.09 seconds.</span></span>
<span><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1200 / 4000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1600 / 4000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2000 / 4000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2001 / 4000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2400 / 4000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2800 / 4000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 3200 / 4000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 3600 / 4000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2:  Elapsed Time: 0.175 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 2:                0.2 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2:                0.375 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 2:</span></span>
<span><span class="va">outstandR_gcomp_stan</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-imputation-marginalisation">Multiple imputation marginalisation<a class="anchor" aria-label="anchor" href="#multiple-imputation-marginalisation"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outstandR_mim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outstandR.html">outstandR</a></span><span class="op">(</span><span class="va">AC.IPD</span>, <span class="va">BC.ALD</span>, strategy <span class="op">=</span> <span class="fu"><a href="../reference/strategy.html">strategy_mim</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lin_form</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 1.6e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.16 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:    1 / 4000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  400 / 4000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  800 / 4000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1001 / 4000 [ 25%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1400 / 4000 [ 35%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1800 / 4000 [ 45%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2200 / 4000 [ 55%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2600 / 4000 [ 65%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 3000 / 4000 [ 75%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 3400 / 4000 [ 85%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 3800 / 4000 [ 95%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 4000 / 4000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.093 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                0.3 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                0.393 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Gradient evaluation took 1.1e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.</span></span>
<span><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Iteration:    1 / 4000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  400 / 4000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  800 / 4000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1001 / 4000 [ 25%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1400 / 4000 [ 35%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1800 / 4000 [ 45%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2200 / 4000 [ 55%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2600 / 4000 [ 65%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 3000 / 4000 [ 75%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 3400 / 4000 [ 85%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 3800 / 4000 [ 95%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 4000 / 4000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2:  Elapsed Time: 0.085 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 2:                0.288 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2:                0.373 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 2:</span></span>
<span><span class="va">outstandR_mim</span></span></code></pre></div>
<p>Combine all outputs</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  `MAIC` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">outstandR_maic</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span>,</span>
<span>  `STC` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">outstandR_stc</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span>,</span>
<span>  `Gcomp ML` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">outstandR_gcomp_ml</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span>,</span>
<span>  `Gcomp Bayes` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">outstandR_gcomp_stan</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span>,</span>
<span>  `MIM` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">outstandR_mim</span><span class="op">$</span><span class="va">contrasts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">MAIC</th>
<th align="right">STC</th>
<th align="right">Gcomp.ML</th>
<th align="right">Gcomp.Bayes</th>
<th align="right">MIM</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AB</td>
<td align="right">0.019758</td>
<td align="right">0.0133028</td>
<td align="right">0.0140737</td>
<td align="right">0.0119835</td>
<td align="right">0.0124093</td>
</tr>
<tr class="even">
<td align="left">AC</td>
<td align="right">-0.270242</td>
<td align="right">-0.2766972</td>
<td align="right">-0.2759263</td>
<td align="right">-0.2780165</td>
<td align="right">-0.2775907</td>
</tr>
<tr class="odd">
<td align="left">BC</td>
<td align="right">-0.290000</td>
<td align="right">-0.2900000</td>
<td align="right">-0.2900000</td>
<td align="right">-0.2900000</td>
<td align="right">-0.2900000</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nathan Green, Antonio Remiro-Azocar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
